package cn.machine.geek;

/**
 * 69. x çš„å¹³æ–¹æ ¹
 * å®ç° int sqrt(int x) å‡½æ•°ã€‚
 * <p>
 * è®¡ç®—å¹¶è¿”å› x çš„å¹³æ–¹æ ¹ï¼Œå…¶ä¸­ x æ˜¯éè´Ÿæ•´æ•°ã€‚
 * <p>
 * ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œç»“æœåªä¿ç•™æ•´æ•°çš„éƒ¨åˆ†ï¼Œå°æ•°éƒ¨åˆ†å°†è¢«èˆå»ã€‚
 * <p>
 * ç¤ºä¾‹ 1:
 * <p>
 * è¾“å…¥: 4
 * è¾“å‡º: 2
 * ç¤ºä¾‹ 2:
 * <p>
 * è¾“å…¥: 8
 * è¾“å‡º: 2
 * è¯´æ˜: 8 çš„å¹³æ–¹æ ¹æ˜¯ 2.82842...,
 * ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œå°æ•°éƒ¨åˆ†å°†è¢«èˆå»ã€‚
 */
public class xçš„å¹³æ–¹æ ¹ {
    public int mySqrt(int x) {
        if (x == 0) {
            return 0;
        }
        double C = x, x0 = x;
        while (true) {
            double x1 = (0.5 * (x0 + C / x0));
            if (Math.abs(x0 - x1) < 1e-7) {
                break;
            }
            x0 = x1;
        }
        return (int) x0;
    }
    /**
     * ğŸ“– æ–‡å­—é¢˜è§£
     * å‰è¨€
     * æœ¬é¢˜æ˜¯ä¸€é“å¸¸è§çš„é¢è¯•é¢˜ï¼Œé¢è¯•å®˜ä¸€èˆ¬ä¼šè¦æ±‚é¢è¯•è€…åœ¨ä¸ä½¿ç”¨ \sqrt{x}
     * x
     * â€‹
     *   å‡½æ•°çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ° xx çš„å¹³æ–¹æ ¹çš„æ•´æ•°éƒ¨åˆ†ã€‚ä¸€èˆ¬çš„æ€è·¯ä¼šæœ‰ä»¥ä¸‹å‡ ç§ï¼š
     *
     * é€šè¿‡å…¶å®ƒçš„æ•°å­¦å‡½æ•°ä»£æ›¿å¹³æ–¹æ ¹å‡½æ•°å¾—åˆ°ç²¾ç¡®ç»“æœï¼Œå–æ•´æ•°éƒ¨åˆ†ä½œä¸ºç­”æ¡ˆï¼›
     *
     * é€šè¿‡æ•°å­¦æ–¹æ³•å¾—åˆ°è¿‘ä¼¼ç»“æœï¼Œç›´æ¥ä½œä¸ºç­”æ¡ˆã€‚
     *
     * æ–¹æ³•ä¸€ï¼šè¢–çè®¡ç®—å™¨ç®—æ³•
     * ã€Œè¢–çè®¡ç®—å™¨ç®—æ³•ã€æ˜¯ä¸€ç§ç”¨æŒ‡æ•°å‡½æ•° \expexp å’Œå¯¹æ•°å‡½æ•° \lnln ä»£æ›¿å¹³æ–¹æ ¹å‡½æ•°çš„æ–¹æ³•ã€‚æˆ‘ä»¬é€šè¿‡æœ‰é™çš„å¯ä»¥ä½¿ç”¨çš„æ•°å­¦å‡½æ•°ï¼Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦è®¡ç®—çš„ç»“æœã€‚
     *
     * æˆ‘ä»¬å°† \sqrt{x}
     * x
     * â€‹
     *   å†™æˆå¹‚çš„å½¢å¼ x^{1/2}x
     * 1/2
     *  ï¼Œå†ä½¿ç”¨è‡ªç„¶å¯¹æ•° ee è¿›è¡Œæ¢åº•ï¼Œå³å¯å¾—åˆ°
     *
     * \sqrt{x} = x^{1/2} = (e ^ {\ln x})^{1/2} = e^{\frac{1}{2} \ln x}
     * x
     * â€‹
     *  =x
     * 1/2
     *  =(e
     * lnx
     *  )
     * 1/2
     *  =e
     * 2
     * 1
     * â€‹
     *  lnx
     *
     *
     * è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ° \sqrt{x}
     * x
     * â€‹
     *   çš„å€¼äº†ã€‚
     *
     * æ³¨æ„ï¼š ç”±äºè®¡ç®—æœºæ— æ³•å­˜å‚¨æµ®ç‚¹æ•°çš„ç²¾ç¡®å€¼ï¼ˆæµ®ç‚¹æ•°çš„å­˜å‚¨æ–¹æ³•å¯ä»¥å‚è€ƒ IEEE 754ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼‰ï¼Œè€ŒæŒ‡æ•°å‡½æ•°å’Œå¯¹æ•°å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼å‡ä¸ºæµ®ç‚¹æ•°ï¼Œå› æ­¤è¿ç®—è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨è¯¯å·®ã€‚ä¾‹å¦‚å½“ x = 2147395600x=2147395600 æ—¶ï¼Œe^{\frac{1}{2} \ln x}e
     * 2
     * 1
     * â€‹
     *  lnx
     *   çš„è®¡ç®—ç»“æœä¸æ­£ç¡®å€¼ 4634046340 ç›¸å·® 10^{-11}10
     * âˆ’11
     *  ï¼Œè¿™æ ·åœ¨å¯¹ç»“æœå–æ•´æ•°éƒ¨åˆ†æ—¶ï¼Œä¼šå¾—åˆ° 4633946339 è¿™ä¸ªé”™è¯¯çš„ç»“æœã€‚
     *
     * å› æ­¤åœ¨å¾—åˆ°ç»“æœçš„æ•´æ•°éƒ¨åˆ† \textit{ans}ans åï¼Œæˆ‘ä»¬åº”å½“æ‰¾å‡º \textit{ans}ans ä¸ \textit{ans} + 1ans+1 ä¸­å“ªä¸€ä¸ªæ˜¯çœŸæ­£çš„ç­”æ¡ˆã€‚
     *
     * C++JavaPython3Golang
     *
     * class Solution {
     * public:
     *     int mySqrt(int x) {
     *         if (x == 0) {
     *             return 0;
     *         }
     *         int ans = exp(0.5 * log(x));
     *         return ((long long)(ans + 1) * (ans + 1) <= x ? ans + 1 : ans);
     *     }
     * };
     * å¤æ‚åº¦åˆ†æ
     *
     * æ—¶é—´å¤æ‚åº¦ï¼šO(1)O(1)ï¼Œç”±äºå†…ç½®çš„ exp å‡½æ•°ä¸ log å‡½æ•°ä¸€èˆ¬éƒ½å¾ˆå¿«ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå°†å…¶å¤æ‚åº¦è§†ä¸º O(1)O(1)ã€‚
     *
     * ç©ºé—´å¤æ‚åº¦ï¼šO(1)O(1)ã€‚
     *
     * æ–¹æ³•äºŒï¼šäºŒåˆ†æŸ¥æ‰¾
     * ç”±äº xx å¹³æ–¹æ ¹çš„æ•´æ•°éƒ¨åˆ† \textit{ans}ans æ˜¯æ»¡è¶³ k^2 \leq xk
     * 2
     *  â‰¤x çš„æœ€å¤§ kk å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹ kk è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œä»è€Œå¾—åˆ°ç­”æ¡ˆã€‚
     *
     * äºŒåˆ†æŸ¥æ‰¾çš„ä¸‹ç•Œä¸º 00ï¼Œä¸Šç•Œå¯ä»¥ç²—ç•¥åœ°è®¾å®šä¸º xxã€‚åœ¨äºŒåˆ†æŸ¥æ‰¾çš„æ¯ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒä¸­é—´å…ƒç´  \textit{mid}mid çš„å¹³æ–¹ä¸ xx çš„å¤§å°å…³ç³»ï¼Œå¹¶é€šè¿‡æ¯”è¾ƒçš„ç»“æœè°ƒæ•´ä¸Šä¸‹ç•Œçš„èŒƒå›´ã€‚ç”±äºæˆ‘ä»¬æ‰€æœ‰çš„è¿ç®—éƒ½æ˜¯æ•´æ•°è¿ç®—ï¼Œä¸ä¼šå­˜åœ¨è¯¯å·®ï¼Œå› æ­¤åœ¨å¾—åˆ°æœ€ç»ˆçš„ç­”æ¡ˆ \textit{ans}ans åï¼Œä¹Ÿå°±ä¸éœ€è¦å†å»å°è¯• \textit{ans} + 1ans+1 äº†ã€‚
     *
     * C++JavaPython3Golang
     *
     * class Solution {
     * public:
     *     int mySqrt(int x) {
     *         int l = 0, r = x, ans = -1;
     *         while (l <= r) {
     *             int mid = l + (r - l) / 2;
     *             if ((long long)mid * mid <= x) {
     *                 ans = mid;
     *                 l = mid + 1;
     *             } else {
     *                 r = mid - 1;
     *             }
     *         }
     *         return ans;
     *     }
     * };
     * å¤æ‚åº¦åˆ†æ
     *
     * æ—¶é—´å¤æ‚åº¦ï¼šO(\log x)O(logx)ï¼Œå³ä¸ºäºŒåˆ†æŸ¥æ‰¾éœ€è¦çš„æ¬¡æ•°ã€‚
     *
     * ç©ºé—´å¤æ‚åº¦ï¼šO(1)O(1)ã€‚
     *
     * æ–¹æ³•ä¸‰ï¼šç‰›é¡¿è¿­ä»£
     * æ€è·¯
     *
     * ç‰›é¡¿è¿­ä»£æ³•æ˜¯ä¸€ç§å¯ä»¥ç”¨æ¥å¿«é€Ÿæ±‚è§£å‡½æ•°é›¶ç‚¹çš„æ–¹æ³•ã€‚
     *
     * ä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç”¨ CC è¡¨ç¤ºå¾…æ±‚å‡ºå¹³æ–¹æ ¹çš„é‚£ä¸ªæ•´æ•°ã€‚æ˜¾ç„¶ï¼ŒCC çš„å¹³æ–¹æ ¹å°±æ˜¯å‡½æ•°
     *
     * y = f(x) = x^2 - C
     * y=f(x)=x
     * 2
     *  âˆ’C
     *
     * çš„é›¶ç‚¹ã€‚
     *
     * ç‰›é¡¿è¿­ä»£æ³•çš„æœ¬è´¨æ˜¯å€ŸåŠ©æ³°å‹’çº§æ•°ï¼Œä»åˆå§‹å€¼å¼€å§‹å¿«é€Ÿå‘é›¶ç‚¹é€¼è¿‘ã€‚æˆ‘ä»¬ä»»å–ä¸€ä¸ª x_0x
     * 0
     * â€‹
     *   ä½œä¸ºåˆå§‹å€¼ï¼Œåœ¨æ¯ä¸€æ­¥çš„è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°å‡½æ•°å›¾åƒä¸Šçš„ç‚¹ (x_i, f(x_i))(x
     * i
     * â€‹
     *  ,f(x
     * i
     * â€‹
     *  ))ï¼Œè¿‡è¯¥ç‚¹ä½œä¸€æ¡æ–œç‡ä¸ºè¯¥ç‚¹å¯¼æ•° f'(x_i)f
     * â€²
     *  (x
     * i
     * â€‹
     *  ) çš„ç›´çº¿ï¼Œä¸æ¨ªè½´çš„äº¤ç‚¹è®°ä¸º x_{i+1}x
     * i+1
     * â€‹
     *  ã€‚x_{i+1}x
     * i+1
     * â€‹
     *   ç›¸è¾ƒäº x_ix
     * i
     * â€‹
     *   è€Œè¨€è·ç¦»é›¶ç‚¹æ›´è¿‘ã€‚åœ¨ç»è¿‡å¤šæ¬¡è¿­ä»£åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè·ç¦»é›¶ç‚¹éå¸¸æ¥è¿‘çš„äº¤ç‚¹ã€‚ä¸‹å›¾ç»™å‡ºäº†ä» x_0x
     * 0
     * â€‹
     *   å¼€å§‹è¿­ä»£ä¸¤æ¬¡ï¼Œå¾—åˆ° x_1x
     * 1
     * â€‹
     *   å’Œ x_2x
     * 2
     * â€‹
     *   çš„è¿‡ç¨‹ã€‚
     *
     *
     *
     * ç®—æ³•
     *
     * æˆ‘ä»¬é€‰æ‹© x_0 = Cx
     * 0
     * â€‹
     *  =C ä½œä¸ºåˆå§‹å€¼ã€‚
     *
     * åœ¨æ¯ä¸€æ­¥è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å½“å‰çš„äº¤ç‚¹ x_ix
     * i
     * â€‹
     *  ï¼Œæ‰¾åˆ°å‡½æ•°å›¾åƒä¸Šçš„ç‚¹ (x_i, x_i^2 - C)(x
     * i
     * â€‹
     *  ,x
     * i
     * 2
     * â€‹
     *  âˆ’C)ï¼Œä½œä¸€æ¡æ–œç‡ä¸º f'(x_i) = 2x_if
     * â€²
     *  (x
     * i
     * â€‹
     *  )=2x
     * i
     * â€‹
     *   çš„ç›´çº¿ï¼Œç›´çº¿çš„æ–¹ç¨‹ä¸ºï¼š
     *
     * \begin{aligned} y_l &= 2x_i(x - x_i) + x_i^2 - C \\ &= 2x_ix - (x_i^2 + C) \end{aligned}
     * y
     * l
     * â€‹
     *
     * â€‹
     *
     * =2x
     * i
     * â€‹
     *  (xâˆ’x
     * i
     * â€‹
     *  )+x
     * i
     * 2
     * â€‹
     *  âˆ’C
     * =2x
     * i
     * â€‹
     *  xâˆ’(x
     * i
     * 2
     * â€‹
     *  +C)
     * â€‹
     *
     *
     * ä¸æ¨ªè½´çš„äº¤ç‚¹ä¸ºæ–¹ç¨‹ 2x_ix - (x_i^2 + C) = 02x
     * i
     * â€‹
     *  xâˆ’(x
     * i
     * 2
     * â€‹
     *  +C)=0 çš„è§£ï¼Œå³ä¸ºæ–°çš„è¿­ä»£ç»“æœ x_{i+1}x
     * i+1
     * â€‹
     *  ï¼š
     *
     * x_{i+1} = \frac{1}{2}\left(x_i + \frac{C}{x_i}\right)
     * x
     * i+1
     * â€‹
     *  =
     * 2
     * 1
     * â€‹
     *  (x
     * i
     * â€‹
     *  +
     * x
     * i
     * â€‹
     *
     * C
     * â€‹
     *  )
     *
     * åœ¨è¿›è¡Œ kk æ¬¡è¿­ä»£åï¼Œx_kx
     * k
     * â€‹
     *   çš„å€¼ä¸çœŸå®çš„é›¶ç‚¹ \sqrt{C}
     * C
     * â€‹
     *   è¶³å¤Ÿæ¥è¿‘ï¼Œå³å¯ä½œä¸ºç­”æ¡ˆã€‚
     *
     * ç»†èŠ‚
     *
     * ä¸ºä»€ä¹ˆé€‰æ‹© x_0 = Cx
     * 0
     * â€‹
     *  =C ä½œä¸ºåˆå§‹å€¼ï¼Ÿ
     *
     * å› ä¸º y = x^2 - Cy=x
     * 2
     *  âˆ’C æœ‰ä¸¤ä¸ªé›¶ç‚¹ -\sqrt{C}âˆ’
     * C
     * â€‹
     *   å’Œ \sqrt{C}
     * C
     * â€‹
     *  ã€‚å¦‚æœæˆ‘ä»¬å–çš„åˆå§‹å€¼è¾ƒå°ï¼Œå¯èƒ½ä¼šè¿­ä»£åˆ° -\sqrt{C}âˆ’
     * C
     * â€‹
     *   è¿™ä¸ªé›¶ç‚¹ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°çš„æ˜¯ \sqrt{C}
     * C
     * â€‹
     *   è¿™ä¸ªé›¶ç‚¹ã€‚å› æ­¤é€‰æ‹© x_0 = Cx
     * 0
     * â€‹
     *  =C ä½œä¸ºåˆå§‹å€¼ï¼Œæ¯æ¬¡è¿­ä»£å‡æœ‰ x_{i+1} < x_ix
     * i+1
     * â€‹
     *  <x
     * i
     * â€‹
     *  ï¼Œé›¶ç‚¹ \sqrt{C}
     * C
     * â€‹
     *   åœ¨å…¶å·¦ä¾§ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šä¼šè¿­ä»£åˆ°è¿™ä¸ªé›¶ç‚¹ã€‚
     * è¿­ä»£åˆ°ä½•æ—¶æ‰ç®—ç»“æŸï¼Ÿ
     *
     * æ¯ä¸€æ¬¡è¿­ä»£åï¼Œæˆ‘ä»¬éƒ½ä¼šè·ç¦»é›¶ç‚¹æ›´è¿›ä¸€æ­¥ï¼Œæ‰€ä»¥å½“ç›¸é‚»ä¸¤æ¬¡è¿­ä»£å¾—åˆ°çš„äº¤ç‚¹éå¸¸æ¥è¿‘æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–­å®šï¼Œæ­¤æ—¶çš„ç»“æœå·²ç»è¶³å¤Ÿæˆ‘ä»¬å¾—åˆ°ç­”æ¡ˆäº†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥åˆ¤æ–­ç›¸é‚»ä¸¤æ¬¡è¿­ä»£çš„ç»“æœçš„å·®å€¼æ˜¯å¦å°äºä¸€ä¸ªæå°çš„éè´Ÿæ•° \epsilonÏµï¼Œå…¶ä¸­ \epsilonÏµ ä¸€èˆ¬å¯ä»¥å– 10^{-6}10
     * âˆ’6
     *   æˆ– 10^{-7}10
     * âˆ’7
     *  ã€‚
     * å¦‚ä½•é€šè¿‡è¿­ä»£å¾—åˆ°çš„è¿‘ä¼¼é›¶ç‚¹å¾—å‡ºæœ€ç»ˆçš„ç­”æ¡ˆï¼Ÿ
     *
     * ç”±äº y = f(x)y=f(x) åœ¨ [\sqrt{C}, +\infty][
     * C
     * â€‹
     *  ,+âˆ] ä¸Šæ˜¯å‡¸å‡½æ•°ï¼ˆconvex functionï¼‰ä¸”æ’å¤§äºç­‰äºé›¶ï¼Œé‚£ä¹ˆåªè¦æˆ‘ä»¬é€‰å–çš„åˆå§‹å€¼ x_0x
     * 0
     * â€‹
     *   å¤§äºç­‰äº \sqrt{C}
     * C
     * â€‹
     *  ï¼Œæ¯æ¬¡è¿­ä»£å¾—åˆ°çš„ç»“æœ x_ix
     * i
     * â€‹
     *   éƒ½ä¼šæ’å¤§äºç­‰äº \sqrt{C}
     * C
     * â€‹
     *  ã€‚å› æ­¤åªè¦ \epsilonÏµ é€‰æ‹©åœ°è¶³å¤Ÿå°ï¼Œæœ€ç»ˆçš„ç»“æœ x_kx
     * k
     * â€‹
     *   åªä¼šç¨ç¨å¤§äºçœŸæ­£çš„é›¶ç‚¹ \sqrt{C}
     * C
     * â€‹
     *  ã€‚åœ¨é¢˜ç›®ç»™å‡ºçš„ 32 ä½æ•´æ•°èŒƒå›´å†…ï¼Œä¸ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š
     *
     * çœŸæ­£çš„é›¶ç‚¹ä¸º n - 1/2\epsilonnâˆ’1/2Ïµï¼Œå…¶ä¸­ nn æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè€Œæˆ‘ä»¬è¿­ä»£å¾—åˆ°çš„ç»“æœä¸º n + 1/2\epsilonn+1/2Ïµã€‚åœ¨å¯¹ç»“æœä¿ç•™æ•´æ•°éƒ¨åˆ†åå¾—åˆ° nnï¼Œä½†æ­£ç¡®çš„ç»“æœä¸º n - 1nâˆ’1ã€‚
     *
     * C++JavaPython3Golang
     *
     * class Solution {
     *     public int mySqrt(int x) {
     *         if (x == 0) {
     *             return 0;
     *         }
     *
     *         double C = x, x0 = x;
     *         while (true) {
     *             double xi = 0.5 * (x0 + C / x0);
     *             if (Math.abs(x0 - xi) < 1e-7) {
     *                 break;
     *             }
     *             x0 = xi;
     *         }
     *         return (int) x0;
     *     }
     * }
     * å¤æ‚åº¦åˆ†æ
     *
     * æ—¶é—´å¤æ‚åº¦ï¼šO(\log x)O(logx)ï¼Œæ­¤æ–¹æ³•æ˜¯äºŒæ¬¡æ”¶æ•›çš„ï¼Œç›¸è¾ƒäºäºŒåˆ†æŸ¥æ‰¾æ›´å¿«ã€‚
     *
     * ç©ºé—´å¤æ‚åº¦ï¼šO(1)O(1)ã€‚
     *
     * ä½œè€…ï¼šLeetCode-Solution
     * é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/sqrtx/solution/x-de-ping-fang-gen-by-leetcode-solution/
     * æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
     * è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
     */
}
